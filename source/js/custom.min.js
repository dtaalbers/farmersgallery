jQuery(document).ready(function(e){function t(t){$preloader.fadeOut("fast"),t.removeAttr("width").removeAttr("height").css({width:"",height:""}),$bg.data("originalImageWidth",t.width()).data("originalImageHeight",t.height()),$bg.data("newTitle")&&t.attr("title",$bg.data("newTitle")),i(t),$bg.data("nextImage",e(e("#outer_container").data("selectedThumb")).next().attr("href")),"undefined"!=typeof itemIndex&&itemIndex==lastItemIndex?($bg.data("lastImageReached","Y"),$bg.data("nextImage",e("#outer_container a.thumb_link").first().attr("href"))):$bg.data("lastImageReached","N"),t.fadeIn("slow"),($bg.data("nextImage")||"Y"==$bg.data("lastImageReached"))&&o("close"),a()}function a(){$bg.data("nextImage")&&$nextimage_tip.stop().css("right",20).fadeIn("fast").fadeOut(2e3,"easeInExpo",function(){$nextimage_tip.css("right",e(window).width())})}function o(t){var a=900,o="easeInOutExpo";"open"==t?(e("#arrow_indicator").fadeTo("fast",0),e("#outer_container").stop().animate({left:0},a,o),$bg.stop().animate({left:585},a,o)):(e("#outer_container").stop().animate({left:-590},a,o),$bg.stop().animate({left:0},a,o,function(){e("#arrow_indicator").fadeTo("fast",1)}))}function i(t){var a=e(window).width(),o=e(window).height(),i=e(t).width(),r=e(t).height();if("original"!=$toolbar.data("imageViewMode")){e(t).removeClass("with_border").removeClass("with_shadow");var n=r/i,g=i/r;"fit"!=$toolbar.data("imageViewMode")?n>o/a?e(t).css("width",a).css("height",n*a):e(t).css("height",o).css("width",g*o):o/a>n?e(t).css("width",a).css("height",n*a):e(t).css("height",o).css("width",g*o),e(t).css("margin-left",(a-e(t).width())/2).css("margin-top",(o-e(t).height())/2)}else e(t).addClass("with_border").addClass("with_shadow"),e(t).css("width",$bg.data("originalImageWidth")).css("height",$bg.data("originalImageHeight")),e(t).css("margin-left",(a-e(t).outerWidth())/2).css("margin-top",(o-e(t).outerHeight())/2)}function r(e){$toolbar.data("imageViewMode",e),i($bgimg),$toolbar.html("full"==e?"<span class='lightgrey'>"+farmer.ViewMode+" &rsaquo;</span> "+farmer.full:"fit"==e?"<span class='lightgrey'>"+farmer.ViewMode+" &rsaquo;</span> "+farmer.fit:"<span class='lightgrey'>"+farmer.ViewMode+" &rsaquo;</span> "+farmer.original)}$defaultViewMode="full",$bg=e("#bg"),$bgimg=e("#bg #bgimg"),$preloader=e("#preloader"),$toolbar=e("#toolbar"),$nextimage_tip=e("#nextimage_tip"),e(window).load(function(){function a(){function t(){var e=(totalContent-visibleHeight/bottomSpace)/(draggerContainerHeight-draggerHeight),t=$dragger.position().top;targY=-t*e;var a=$customScrollBox_container.position().top-targY;$customScrollBox_container.stop().animate({top:"-="+a},animSpeed,easeType)}function a(){$dragger.css("background","url(round_custom_scrollbar_bg_over.png)")}function o(){$dragger.css("background","url(round_custom_scrollbar_bg.png)")}outerMargin=0,innerMargin=20,$customScrollBox.height(e(window).height()-outerMargin),$dragger_container.height(e(window).height()-innerMargin),visibleHeight=e(window).height()-outerMargin,$customScrollBox_container.height()>visibleHeight?($dragger.css("display","block"),totalContent=$customScrollBox_content.height(),draggerContainerHeight=e(window).height()-innerMargin,animSpeed=400,easeType="easeOutCirc",bottomSpace=1.05,targY=0,draggerHeight=$dragger.height(),$dragger.draggable({axis:"y",containment:"parent",drag:function(){t()},stop:function(){o()}}),$dragger_container.click(function(a){var o=a.pageY-e(this).offset().top,i=o+$dragger.height();draggerContainerHeight>i?($dragger.css("top",o),t()):($dragger.css("top",draggerContainerHeight-$dragger.height()),t())}),e(function(){$customScrollBox.bind("mousewheel",function(e,a){return vel=Math.abs(10*a),$dragger.css("top",$dragger.position().top-a*vel),t(),$dragger.position().top<0&&($dragger.css("top",0),$customScrollBox_container.stop(),t()),$dragger.position().top>draggerContainerHeight-$dragger.height()&&($dragger.css("top",draggerContainerHeight-$dragger.height()),$customScrollBox_container.stop(),t()),!1})}),$dragger.mouseup(function(){o()}).mousedown(function(){a()})):$dragger_container.css("display","none")}$toolbar.data("imageViewMode",$defaultViewMode),r($toolbar.data("imageViewMode")),$customScrollBox=e("#customScrollBox"),$customScrollBox_container=e("#customScrollBox .container"),$customScrollBox_content=e("#customScrollBox .content"),$dragger_container=e("#dragger_container"),$dragger=e("#dragger"),a(),e(window).resize(function(){i("#bgimg"),$dragger.css("top",0),$customScrollBox_container.css("top",0),$customScrollBox.unbind("mousewheel"),a()}),t($bgimg)}),$bgimg.load(function(){t(e(this))}),e("#outer_container").hover(function(){o("open")},function(){o("close")}),$bgimg.click(function(){var t=e(this);if($bg.data("nextImage")){t.css("display","none"),$preloader.fadeIn("fast"),e(e("#outer_container").data("selectedThumb")).children(".selected").css("display","none"),"Y"!=$bg.data("lastImageReached")?e(e("#outer_container").data("selectedThumb")).next().children(".selected").css("display","block"):e("#outer_container a.thumb_link").first().children(".selected").css("display","block");var a=e("#outer_container").data("selectedThumb");"Y"!=$bg.data("lastImageReached")?e("#outer_container").data("selectedThumb",e(a).next()):e("#outer_container").data("selectedThumb",e("#outer_container a.thumb_link").first()),$bg.data("newTitle",e(e("#outer_container").data("selectedThumb")).children("img").attr("title")),"Y"!=$bg.data("lastImageReached")?itemIndex++:itemIndex=0,t.attr("src","").attr("src",$bg.data("nextImage"))}}),$toolbar.hover(function(){e(this).stop().fadeTo("fast",1)},function(){e(this).stop().fadeTo("fast",.8)}),$toolbar.stop().fadeTo("fast",.8),$toolbar.click(function(){"full"==$toolbar.data("imageViewMode")?r("fit"):"fit"==$toolbar.data("imageViewMode")?r("original"):"original"==$toolbar.data("imageViewMode")&&r("full")});var n=["ajax-loader_dark.gif","round_custom_scrollbar_bg_over.png"];e.each(n,function(e){n[e]=new Image,n[e].src=this})});